# üîê –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–û–°–¢–£–ü–û–ú –ù–ê –û–°–ù–û–í–ï –†–û–õ–ï–ô (RBAC) - UK COMMISSION ADMIN PANEL

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-09-06

---

## 1. üéØ –û–±–∑–æ—Ä

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (Role-Based Access Control, RBAC), —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –≤ –ø—Ä–æ–µ–∫—Ç–µ UK Commission Admin Panel. –¶–µ–ª—å —ç—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–æ–ª–∂–Ω–æ—Å—Ç–Ω—ã—Ö –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ù–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —Å–æ—á–µ—Ç–∞—è RBAC –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—â–∏—Ö –ø—Ä–∞–≤ –∏ ABAC (Attribute-Based Access Control) –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ —ç—Ç–æ–π —Å–¥–µ–ª–∫–∏?").

## 2. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ Django:

-   **–†–æ–ª–∏ (Roles):** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `django.contrib.auth.models.Group`.
-   **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è (Permissions):** –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç `rest_framework.permissions.BasePermission`. –≠—Ç–∏ –∫–ª–∞—Å—Å—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `backend/apps/commission/permissions.py`.
-   **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ö–ª–∞—Å—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ `ViewSet` –≤ —Ñ–∞–π–ª–µ `backend/apps/commission/api_views.py`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞—â–∏—â–∞—Ç—å –∫–∞–∫ —Ü–µ–ª—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, —Ç–∞–∫ –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (`approve`, `pay` –∏ —Ç.–¥.).

---

## 3. üë• –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –†–æ–ª–∏ –∏ –ò—Ö –ü—Ä–∞–≤–∞

–í —Å–∏—Å—Ç–µ–º–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ–ª–∏ (–≥—Ä—É–ø–ø—ã). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –Ω–∞ —ç—Ç–∏ —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Django.

### Î°§ Consultant (–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç)
–≠—Ç–æ –±–∞–∑–æ–≤–∞—è —Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤.

-   **CRUD –û–ø–µ—Ä–∞—Ü–∏–∏:** –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å **—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏** —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (–∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–¥–µ–ª–∫–∏, —Å–ø–ª–∏—Ç—ã –∏ —Ç.–¥.).
-   **–î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º:** –ù–µ –≤–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤.
-   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ù–µ –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å, –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—è—Ç—å —Å–¥–µ–ª–∫–∏ (–¥–∞–∂–µ —Å–≤–æ–∏). –ù–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º —Å–∏—Å—Ç–µ–º—ã.

### Î°§ Manager (–ú–µ–Ω–µ–¥–∂–µ—Ä)
–†–æ–ª—å –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –∫–æ–º–∞–Ω–¥.

-   **–í—Å–µ –ø—Ä–∞–≤–∞ –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞:** –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–¥–µ–ª–∫–∞–º–∏.
-   **–î–æ—Å—Ç—É–ø –∫ –∫–æ–º–∞–Ω–¥–µ:** –ú–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã (–∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–¥–µ–ª–∫–∏) **–≤—Å–µ–π —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã**, –≤–∫–ª—é—á–∞—è –≤—Å–µ—Ö –Ω–∏–∂–µ—Å—Ç–æ—è—â–∏—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `django-mptt`).
-   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏:** –ú–æ–∂–µ—Ç **–æ–¥–æ–±—Ä—è—Ç—å (`approve`)**, **–≤—ã–ø–ª–∞—á–∏–≤–∞—Ç—å (`pay`)** –∏ **–æ—Ç–∫–ª–æ–Ω—è—Ç—å (`reject`)** —Å–¥–µ–ª–∫–∏ –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã.
-   **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –ò–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç—á–µ—Ç–∞–º –ø–æ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–µ –∏ –∫ —Å–ø–∏—Å–∫—É —Ç–æ–ø-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π.

### Î°§ Admin (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
–†–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

-   **–ü–æ–ª–Ω—ã–π CRUD-–¥–æ—Å—Ç—É–ø:** –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å **–ª—é–±—ã–µ** –æ–±—ä–µ–∫—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–µ (—Å–¥–µ–ª–∫–∏, –∫–ª–∏–µ–Ω—Ç—ã, –±–æ–Ω—É—Å—ã –∏ —Ç.–¥.).
-   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏:** –ò–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ **–î–≤–∏–∂–∫—É –ø—Ä–∞–≤–∏–ª** (Commission Rules Engine) ‚Äî –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞–±–æ—Ä—ã –ø—Ä–∞–≤–∏–ª –∏ —Å–∞–º–∏ –ø—Ä–∞–≤–∏–ª–∞.
-   **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –ò–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ —Å–∏—Å—Ç–µ–º–µ.
-   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –ù–µ –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏.

### Î°§ Production Admin (–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
–°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∏—Å—Ç–µ–º—ã —Å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏.

-   **–í—Å–µ –ø—Ä–∞–≤–∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.**
-   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:** –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, —É–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∏–º —Ä–æ–ª–∏ (–≥—Ä—É–ø–ø—ã).
-   **–î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –ª–æ–≥–∞–º:** –ò–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–º –ª–æ–≥–∞–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º.
-   **–ü—Ä–∞–≤–∞:** –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç `is_superuser` –≤ Django.

---

## 4. ‚öôÔ∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤

| API –≠–Ω–¥–ø–æ–∏–Ω—Ç | –î–µ–π—Å—Ç–≤–∏–µ | Consultant | Manager | Admin |
| :--- | :--- | :--- | :--- | :--- |
| `GET /api/deals/` | –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Å–¥–µ–ª–æ–∫ | –¢–æ–ª—å–∫–æ —Å–≤–æ–∏ | –°–≤–æ–∏ + –∫–æ–º–∞–Ω–¥—ã | –í—Å–µ |
| `POST /api/deals/` | –°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | ‚úÖ | ‚úÖ | ‚úÖ |
| `PUT /api/deals/{id}/` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | –¢–æ–ª—å–∫–æ —Å–≤–æ–µ–π | –°–≤–æ–µ–π + –∫–æ–º–∞–Ω–¥—ã | –õ—é–±–æ–π |
| `DELETE /api/deals/{id}/` | –£–¥–∞–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | –¢–æ–ª—å–∫–æ —Å–≤–æ–µ–π | –°–≤–æ–µ–π + –∫–æ–º–∞–Ω–¥—ã | –õ—é–±–æ–π |
| `PUT /api/deals/{id}/approve/` | –û–¥–æ–±—Ä–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | ‚ùå | ‚úÖ | ‚úÖ |
| `GET /api/statistics/` | –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ | ‚ùå | –¢–æ–ª—å–∫–æ –ø–æ –∫–æ–º–∞–Ω–¥–µ | ‚úÖ |
| `GET /admin/` | –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ | ‚ùå | ‚ùå | ‚úÖ |

---

## 5. üí° –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (ABAC)

–¢–µ–∫—É—â–∞—è RBAC-—Å–∏—Å—Ç–µ–º–∞ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ—á–Ω—ã–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º. –î–ª—è –µ—â–µ –±–æ–ª–µ–µ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å **Attribute-Based Access Control (ABAC)**.

**–ü—Ä–∏–º–µ—Ä:**
*   **–ü—Ä–∞–≤–∏–ª–æ ABAC:** –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å —Å–¥–µ–ª–∫–∏ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ `deal.base_amount` –º–µ–Ω—å—à–µ –µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞ (`user.approval_limit`).
*   **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `approval_limit` –≤ –º–æ–¥–µ–ª—å `CustomUser` –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –≤ –∫–∞—Å—Ç–æ–º–Ω–æ–º –∫–ª–∞—Å—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π `IsManagerForObject`.
