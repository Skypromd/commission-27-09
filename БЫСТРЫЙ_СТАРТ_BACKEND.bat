@echo off
chcp 65001 >nul
title ๐จ ะญะะกะขะะะะะซะ ะะะะฃะกะ DJANGO BACKEND ๐จ
color 0C

echo.
echo ๐จ============================================๐จ
echo    ะญะะกะขะะะะะซะ ะะะะฃะกะ DJANGO BACKEND
echo ๐จ============================================๐จ
echo.
echo ๐ฅ ะะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ Django ัะตัะฒะตัะฐ...
echo ๐ก ะะพัั: 8000
echo ๐ URL: http://127.0.0.1:8000
echo.

rem ะฃะฑะธะฒะฐะตะผ ะฟัะพัะตััั ะฝะฐ ะฟะพััั 8000
echo ๐ ะัะธััะบะฐ ะฟะพััะฐ 8000...
for /f "tokens=5" %%a in ('netstat -aon ^| findstr :8000') do (
    echo    - ะะฐะฒะตััะฐั ะฟัะพัะตัั ั PID %%a...
    taskkill /f /pid %%a >nul 2>&1
)
echo [+] ะะพัั 8000 ัะฒะพะฑะพะดะตะฝ.
timeout /t 1 /nobreak >nul

rem ะัะพะฒะตััะตะผ ะบะปััะตะฒะพะน ัะฐะนะป Django
if not exist "manage.py" (
    echo โ ะคะฐะนะป manage.py ะฝะต ะฝะฐะนะดะตะฝ!
    echo ๐ก ะะฐะฟัััะธัะต ัะบัะธะฟั ะธะท ะบะพัะฝั ะฟัะพะตะบัะฐ.
    pause
    exit /b 1
)

rem ะะบัะธะฒะธััะตะผ ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
echo.
echo --- ะะบัะธะฒะฐัะธั ะฒะธัััะฐะปัะฝะพะน ััะตะดั ---
if not exist venv\Scripts\activate.bat (
    echo [!] ะะธัััะฐะปัะฝะฐั ััะตะดะฐ 'venv' ะฝะต ะฝะฐะนะดะตะฝะฐ.
    echo     ะะพะถะฐะปัะนััะฐ, ะทะฐะฟัััะธัะต 'run.bat' ะดะปั ะฟะพะปะฝะพะน ะฝะฐัััะพะนะบะธ.
    pause
    exit /b
)
call venv\Scripts\activate.bat
echo [+] ะะธัััะฐะปัะฝะฐั ััะตะดะฐ ะฐะบัะธะฒะธัะพะฒะฐะฝะฐ.

echo.
echo --- ะัะธะผะตะฝะตะฝะธะต ะผะธะณัะฐัะธะน ะฑะฐะทั ะดะฐะฝะฝัั ---
python manage.py migrate
if errorlevel 1 (
    echo [!] ะัะธะฑะบะฐ ะฟัะธ ะฟัะธะผะตะฝะตะฝะธะธ ะผะธะณัะฐัะธะน. ะกะตัะฒะตั ะผะพะถะตั ัะฐะฑะพัะฐัั ะฝะตะบะพััะตะบัะฝะพ.
) else (
    echo [+] ะะธะณัะฐัะธะธ ััะฟะตัะฝะพ ะฟัะธะผะตะฝะตะฝั.
)

echo.
echo ๐ ะะฐะฟััะบ Django ัะตัะฒะตัะฐ...
start "Django Backend Server" python manage.py runserver

:success
echo.
echo โ================================โ
echo    BACKEND ะกะะะะะ ะะะะฃะกะะะะขะกะฏ!
echo โ================================โ
echo.
echo ๐ ะะพัััะฟะฝัะต URL:
echo    โข ะะดะผะธะฝ-ะฟะฐะฝะตะปั: http://127.0.0.1:8000/admin
echo    โข API (ะตัะปะธ ะฝะฐัััะพะตะฝะพ): http://127.0.0.1:8000/api/
echo.
echo โฑ๏ธ  ะะพะดะพะถะดะธัะต 5 ัะตะบัะฝะด ะดะปั ะฟะพะปะฝะพะณะพ ะทะฐะฟััะบะฐ...
timeout /t 5 /nobreak >nul

rem ะัะบััะฒะฐะตะผ ะฑัะฐัะทะตั
echo ๐ ะัะบัััะธะต ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ ะฒ ะฑัะฐัะทะตัะต...
start "" "http://127.0.0.1:8000/admin"

echo.
echo ๐ BACKEND ะะะะฃะฉะะ!
echo.
pause
